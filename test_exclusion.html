<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Exclusion Zone Test</title>
    <style>
      html, body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow-x: hidden;
        background: #111;
        font-family: 'Inter', system-ui, -apple-system, sans-serif;
        color: #fff;
      }
      canvas {
        display: block;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 0;
      }
      .controls {
        position: relative;
        z-index: 1;
        padding: 20px;
        background: rgba(0, 0, 0, 0.7);
        border-radius: 10px;
        margin: 20px;
        display: inline-block;
      }
      .control-btn {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: white;
        padding: 10px 20px;
        border-radius: 30px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 16px;
        margin: 5px;
      }
      .control-btn:hover {
        background: rgba(255, 255, 255, 0.2);
      }
      .control-btn.active {
        background: rgba(255, 255, 255, 0.3);
        border-color: rgba(255, 255, 255, 0.5);
      }
      h1 {
        margin: 0 0 15px 0;
      }
    </style>
  </head>
  <body>
    <canvas id="background"></canvas>
    <div class="controls">
      <h1>Exclusion Zone Test</h1>
      <div>
        <button class="control-btn active" data-shape="iris">Iris (with exclusion)</button>
        <button class="control-btn" data-shape="sphere">Sphere (no exclusion)</button>
        <button class="control-btn" data-shape="random">Random</button>
      </div>
      <div style="margin-top: 20px;">
        <p id="status">Current shape: Iris with pupil exclusion zone</p>
        <p>Scroll to influence particles and observe how they avoid the exclusion zone.</p>
      </div>
    </div>

    <!-- Load the individual modules -->
    <script src="Config.js"></script>
    <script src="ExclusionZone.js"></script>
    <script src="Particle.js"></script>
    <script src="Camera.js"></script>
    <script src="Renderer.js"></script>
    <script src="ShapeManager.js"></script>
    <script src="AnimationController.js"></script>
    <script src="Particle3DMesh.js"></script>
    
    <script>
      // Initialize the particle mesh with more particles for better testing
      const particleMesh = new Particle3DMesh('background', {
        PARTICLE_COUNT: 500,
        PARTICLE_SIZE: 3,
        CONNECTION_DISTANCE: 200,
        PARTICLE_SPEED: 1.5  // Increase speed to better observe exclusion behavior
      });
      
      // Start with iris shape which has an exclusion zone
      particleMesh.setShape('iris', {
        radius: 400,
        pupilRadius: 150,  // Larger pupil to better observe exclusion
        depth: 100
      }).start();
      
      // Set up button click handlers
      document.querySelectorAll('.control-btn').forEach(button => {
        button.addEventListener('click', () => {
          // Update active button
          document.querySelector('.control-btn.active').classList.remove('active');
          button.classList.add('active');
          
          // Get shape name
          const shapeName = button.getAttribute('data-shape');
          
          // Set shape options based on shape name
          let options = {};
          let statusText = '';
          
          switch(shapeName) {
            case 'iris':
              options = {
                radius: 400,
                pupilRadius: 150,
                depth: 100
              };
              statusText = 'Current shape: Iris with pupil exclusion zone';
              break;
            case 'sphere':
              options = {
                radius: 400
              };
              statusText = 'Current shape: Sphere (no exclusion zone)';
              break;
            case 'random':
              statusText = 'Current shape: Random distribution (no exclusion zone)';
              break;
          }
          
          // Update status text
          document.getElementById('status').textContent = statusText;
          
          // Transition to the new shape
          particleMesh.transitionToShape(shapeName, options, 1500, 'easeInOut');
        });
      });
    </script>
  </body>
</html>
